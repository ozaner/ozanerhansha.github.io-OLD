<!DOCTYPE html>
<html lang="en-us">
  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>
    
      FileToPNG &middot; Oz∀n∈ℝ
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- Load JQuery (JavaScript)-->
  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
      },
      jax: ["input/TeX","output/HTML-CSS"],
      displayAlign: "left !important",
      displayIndent: "0em"
    });
    MathJax.Hub.Queue(function() {
      // Fix <code> tags after MathJax finishes running. This is a
      // hack to overcome a shortcoming of Markdown. Discussion at
      // https://github.com/mojombo/jekyll/issues/199
      var all = MathJax.Hub.getAllJax(), i;
      for(i = 0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

  <!-- Adds MathJax -->
  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <!-- Adds Awesome Icons-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- Collects tags of all posts-->
  
    






  

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-111962015-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-111962015-1');
  </script>
</head>

  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          $$\large{\text {Oz}}\tiny{\underbrace{\large {\text {∀n∈ℝ}}}_{\tiny {\text {For all real n...}}}}$$
        </a>
      </h1>
      <p class="lead">A compilation of my notes, projects, and articles.</p>
    </div>

    <nav class="sidebar-nav">
      <a href="https://medium.com/@ozanerhansha" target="_blank">Articles</a><br/>

      

      
      
        
          
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/notes/">Notes</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/projects/">Projects</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/references/">Interesting References</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <style>
        p.small {
            line-height: 0.7;
        }
      </style>

      <br>

      <p class="small">
        <!--- Icon Links -->
        <b>Links: </b>
        <a href="https://github.com/ozanerhansha"><i class='fa fa-github'></i></a>
        <!-- <a href="https://www.quora.com/profile/Ozaner-Hansha/questions"><i class='fa fa-quora'></i></a> -->
        <a href="https://medium.com/@ozanerhansha"<i class='fa fa-medium'></i></a>
        <!-- <a href="https://math.stackexchange.com/users/490433/ozaner-hansha?tab=questions"><i class='fa fa-stack-exchange'></i></a> -->

        <br>
        <font size="2"><a href="https://github.com/ozanerhansha/ozanerhansha.github.io">This Website's Code</a></font>
      </p>
    </nav>
    <p>2018 Ozaner Hansha</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">FileToPNG</h1>
  <span class="post-date">16 Jan 2018</span>
  <span>[
  
    
    <a href="/tag/computer-science"><code class="highligher-rouge"><nobr>computer-science</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/projects"><code class="highligher-rouge"><nobr>projects</nobr></code>&nbsp;</a>
  
]</span>
  <h2 id="what-is-filetopng">What is FileToPNG?</h2>
<p>FileToPNG is a tool written in Java that converts the raw bit representation of any file into a corresponding PNG representation. The PNG (being a lossless file type) can be sent (via text, email, etc) and finally reconstructed back into a file. The GithHub repository for this project can be found <a href="https://github.com/ozanerhansha/FileToPNG">here</a>.</p>

<p>That said, while the main purpose of FileToPNG was to make a tool for sending files over image only communication channels, I’ve found that the PNG representation of the files have interesting properties based on what kind of files are put in.</p>

<!--more-->

<h2 id="the-main-algorithm">The Main Algorithm</h2>
<p>While I have programmed a primitive UI (the code for which can be found <a href="https://github.com/ozanerhansha/FileToPNG/blob/master/src/Main.java">here</a>) to make using the tool easier, it’s not the main focus of FileToPNG and is really just boilerplate Java.</p>

<p>The real meat of the program is the conversion functions for PNG to File and vice versa. The code for this can be found <a href="https://github.com/ozanerhansha/FileToPNG/blob/master/src/GFile.java">here</a></p>

<p>The algorithm goes something like this:</p>
<ol>
  <li>Convert the file into a string of bytes (8 bits = 1 byte).</li>
  <li>Read through this list and make a pixel out of every 3 bytes. This can be done because a pixel is comprised of 3 colors (red, green, and blue) each with a value from 0-255. These 256 values can be represented in 8 bits (because 2<sup>8</sup>=256).</li>
  <li>Once a list of pixels (which should be about a 1/3 of the size of the byte list) has been made, create a square image (in .png format) out of these pixels.</li>
  <li>Account for files whose bytes aren’t a multiple of 3. (I used special ‘2 byte’ and ‘1 byte’ pixels that have different alpha values to demarcate them)</li>
</ol>

<p>Reconstructing the images into files is as simple as reversing this process.</p>

<h2 id="properties-of-png-representations">Properties of PNG Representations</h2>
<p>The main algorithm doesn’t do any encrypting (as of yet) or rearranging of the file’s bits. As such, the PNG representation of the file can give us an, obfuscated to be sure, look at its structure.</p>

<h3 id="text-files">Text Files</h3>
<p>Take text files for example. Their content, of course, varies widely depending on the length and topic of discussion. But, even if they don’t use the same language, they all still use the same Unicode characters which all have the same configuration of bits. Meaning they share some similarities:</p>

<p><img src="/assets/projects/filetopng/text_diagram.png?style=centerme" alt="Text in FileToPNG" /></p>

<h3 id="1mb-file-of-random-noise-for-comparison">1MB file of random noise for comparison:</h3>
<p><img src="/assets/projects/filetopng/random_data.png?style=centerme" alt="Random Noise" width="500px" /></p>

<h3 id="music-files">Music Files</h3>
<p>This one was kind of surprising. When I took an .mp3 file of a song and put it through the program, the resulting image looked almost random:</p>

<p><img src="/assets/projects/filetopng/song_mp3.png?style=centerme" alt="mp3" width="500px" /></p>

<p>I was disappointed at first, but then I realized that randomness is fundamentally information packed. What I mean is that if the PNG representation had some sort of overarching structure, then that would imply that there is still some redundancy in the file that could be compressed, thereby making the file smaller and more random looking.</p>

<p>This lines up with the fact that mp3 files are <strong>lossy</strong> (i.e they sacrifice perfect quality for a smaller size).</p>

<p><img src="/assets/projects/filetopng/song_wav.png?style=centerme" alt="wav" width="500px" /></p>

<p>The natural step forward at that point was to get a .wav version of the song (which is <strong>lossless</strong>) and see if it had any structure. And as expected, it did. It was also much bigger in size due to being lossless (the size difference isn’t reflected here because it would extend out of the webpage).</p>

<h3 id="nintendo-64-roms">Nintendo 64 ROMs</h3>
<p>As a test I thought I would try converting a couple of Nintendo 64 games (in file form) that were on my desktop to PNGs and, unsurprisingly, they share many similarities:</p>

<p><img src="/assets/projects/filetopng/n64_diagram.png?style=centerme" alt="N64 Roms in FileToPNG" /></p>

<p>Interested, I did some research into N64 cartridges and found out that all ‘ROM dumps’ (files that were created by copying a physical N64 cartridge onto a computer) have what’s called a <em>header</em>. This header includes custodial information like the game’s version, internal name, and other bits of information that would be interesting to a game historian. This header is the black box at the top <em>Super Mario 64</em> and <em>Mario Kart 64</em>.</p>

<p>You may also notice that Super Mario 64 is smaller than Mario Kart 64, implying that it has a smaller file size. Apparently, N64 games came on a variety of hardware with different storage capacities and capabilities. This may seem normal nowadays but in an era where all games had to work on the same piece of limited hardware, this variability is pretty amazing.</p>

<p>Anyway this is also reflected at the bottom of the PNG representations. After the last black bar, both the ROMs are just filled with ‘garbage data’ meant to fill the ROM up. You can tell because this section looks more like the random sample then the rest of the picture.</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/drag-force/">
            Drag Force
            <small>27 Mar 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/friction/">
            Friction
            <small>26 Mar 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/classical-physics/">
            Classical Physics
            <small>24 Mar 2018</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>
  </body>
</html>
